{% extends "recipes/base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<script src="{% static 'admin/js/vendor/jquery/jquery.js' %}"></script>
<div class="content-section">
  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <fieldset class="form-group">
      <legend class="border-bottom mb-4">Neues Rezept</legend>
      <div class="form-group mb-0">
        {{ form.title|as_crispy_field }}
      </div>
      <div class="form-group mb-0">
        {{ form.introduction|as_crispy_field }}
      </div>
      <div class="prep-time form-group mb-0">
        {{ form.prep_time|as_crispy_field }}
      </div>
      <div class="servings-create-view form-group mb-0">
        {{ form.servings|as_crispy_field }}
      </div>
      <table>
        {{ ingredients.management_form|crispy }} {% for form in ingredients.forms %}
        <tr class="{% cycle 'row1' 'row2' %} formset_row-{{ ingredients.prefix }}">
          {% for field in form.visible_fields %}
          <td>
            {# Include the hidden fields in the form #} {% if forloop.first %} {% for hidden in form.hidden_fields %} {{ hidden }} {% endfor %} {% endif %} {{ field.errors.as_ul }} {{ field|as_crispy_field }}
          </td>
          {% endfor %}
        </tr>
        {% endfor %}

      </table>
      <br>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
      </script>
      <script src="{% static 'recipes/jquery.formset.js' %}">
      </script>
      <script type="text/javascript">
        $('.formset_row-{{ ingredients.prefix }}').formset({
          addText: 'add Ingredient',
          deleteText: 'delete',
          prefix: '{{ ingredients.prefix }}',
        });
      </script>
      <div class="form-group mb-0">
        {{ form.directions|as_crispy_field }}
      </div>
      <div class="form-group col-md-6 mb-0">
        {{ form.categories|as_crispy_field }} {{form.media}}
      </div>
      <div class="">
        {{ image|crispy }} {{ image.media }}
      </div>
      <div class="form-group">
        <button class="btn btn-outline-info" type="submit">Save</button>
      </div>
    </fieldset>
  </form>
</div>
{% endblock content %}
